<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="form-style.css">
    <style>
        /* Styles for the non-Bootstrap modals to ensure they appear correctly */
        #add-buyer-modal .modal-content, #annexure-modal .modal-content {
            background-color:#fefefe; margin:5% auto; padding:20px; border:1px solid #888; width:80%; max-width:600px; border-radius: 8px;
        }
        #annexure-modal .modal-content {
             max-width: 1200px; /* Wider modal for annexure */
        }
        
    /* ... your existing styles ... */

    /* Style for the new item comment input field */
    .item-comment {
        font-size: 0.85rem;      /* Makes the text slightly smaller */
        font-style: italic;      /* Italicizes the placeholder text */
        margin-top: 4px;         /* Adds a little space from the description above */
        border-top: 1px solid #eee; /* Adds a subtle separator line */
        box-shadow: none;        /* Removes any default glow on focus */
    }

    /* Style to ensure the red 'X' button aligns well with the taller rows */
    .align-middle .btn {
        vertical-align: middle;
    }

    </style>
</head>
<body>

    <div class="container form-container">
        <h1 class="text-center">EXPORT MANAGEMENT SYSTEM</h1>
       <div style="text-align: center;"> <a href="dashboard.html" class="btn btn-primary">Back to Dashboard</a></div>
<br>

        <form id="invoice-form">
            <input type="hidden" id="invoice-id">

            <div class="card mb-4">
                <div class="card-header">Party Details</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="seller-details" class="form-label"><strong>Seller / Shipper</strong></label>
                            <textarea id="seller-details" rows="6" class="form-control">OSWAL LUMBERS PVT LTD
SURVEY NO. 262, 263, 261/2, 261/3
P.O. BOX 181, NATIONAL HIGHWAY 8A
GANDHIDHAM - 370 201 - KUTCH - GUJARAT - INDIA
EMAIL: INFO@OSWALLUMBERS.COM
GSTIN: 24AAACO3558Q1Z0
IEC NO. 2089000104</textarea>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="buyer-select" class="form-label"><strong>Buyer / Consignee</strong></label>
                            <div class="input-group mb-2">
                                <select id="buyer-select" class="form-select">
                                    <option value="">-- Select or Add New Buyer --</option>
                                </select>
                                <button type="button" id="add-buyer-btn" class="btn btn-outline-secondary">+</button>
                            </div>
                            <textarea id="buyer-details" rows="4" class="form-control"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">Invoice Details</div>
                        <div class="card-body">
                            <div class="mb-3"><label for="invoice-no" class="form-label">Invoice No:</label><input type="text" id="invoice-no" class="form-control" required></div>
                            <div class="mb-3"><label for="invoice-date" class="form-label">Date:</label><input type="date" id="invoice-date" class="form-control" required></div>
                            <div class="mb-3"><label for="iec-no" class="form-label">IEC No:</label><input type="text" id="iec-no" class="form-control" value="2089000104"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header">Shipment Details</div>
                        <div class="card-body">
                            <div class="mb-3"><label for="terms" class="form-label">Terms of Shipment:</label><input type="text" id="terms" class="form-control"></div>
                            <div class="mb-3"><label for="port-loading" class="form-label">Port of Loading:</label><input type="text" id="port-loading" class="form-control" value="MUNDRA, INDIA."></div>
                            <div class="mb-3"><label for="port-discharge" class="form-label">Port of Discharge:</label><input type="text" id="port-discharge" class="form-control"></div>
                            <div class="mb-3"><label for="country-origin" class="form-label">Country of Origin:</label><input type="text" id="country-origin" class="form-control" value="INDIA."></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h2>Items</h2>
            <div class="table-responsive">
                <table id="items-table" class="table table-bordered align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>S. No.</th>
                            <th>Description of Item</th>
                            <th>HSN Code</th>
                            <th>Qty</th>
                            <th>UOM</th>
                            <th>M3</th>
                            <th>Rate (US$/M3)</th>
                            <th>Amount (US$)</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="items-body"></tbody>
                </table>
            </div>
            <button type="button" id="add-row-btn" class="btn btn-primary mb-3">Add Item Row</button>
            
            <div class="mb-3">
                <label for="remarks" class="form-label"><strong>Remarks</strong></label>
                <textarea id="remarks" class="form-control" rows="3" placeholder="Enter any remarks to be printed on the invoice..."></textarea>
            </div>

            <div class="row">
                <div class="col-lg-8">
                    <div class="card mb-3">
                         <div class="card-header">Container & Weight Details</div>
                         <div class="card-body">
                             <div class="row">
                                <div class="col-md-4 mb-2"><label class="form-label">Container No:</label><input type="text" id="container-no" class="form-control"></div>
                                <div class="col-md-4 mb-2"><label class="form-label">Container Size:</label><input type="text" id="container-size" class="form-control" value="1 X 40' CONTAINER"></div>
                                <div class="col-md-4 mb-2"><label class="form-label">Total Items:</label><input type="text" id="total-items" class="form-control"></div>
                                <div class="col-md-4 mb-2"><label class="form-label">Gross Weight:</label><input type="text" id="gross-weight" class="form-control"></div>
                                <div class="col-md-4 mb-2"><label class="form-label">Net Weight:</label><input type="text" id="net-weight" class="form-control"></div>
                             </div>
                         </div>
                    </div>
                     <div class="card mb-3">
                         <div class="card-header">Bank Details</div>
                         <div class="card-body">
                             <textarea id="bank-details" rows="6" class="form-control">BANK DETAILS:
UNION BANK OF INDIA, GANDHIDHAM BRANCH,
GANDHIDHAM - 370 201 - GUJARAT - INDIA
SWIFT CODE: UBININBBGAN
A/C NO.: 560101000092024</textarea>
                         </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card mb-3">
                        <div class="card-header">Totals</div>
                        <div class="card-body">
                            <div class="total-field"><span>Total Quantity:</span><strong id="total-qty">0</strong></div>
                            <div class="total-field"><span>Total M3:</span><strong id="total-m3">0.000</strong></div>
                            <hr>
                            <div class="total-field"><h5>Total Amount:</h5><h5 id="total-amount">$0.00</h5></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="d-grid gap-2 d-md-flex justify-content-md-end border-top pt-3 mt-3">
                <button type="button" class="btn btn-info" id="save-btn">Save Invoice</button>
                <button type="submit" class="btn btn-success">Generate Invoice PDF</button>
                <button type="button" class="btn btn-warning" id="packing-list-btn">Generate Packing List</button>
                <button type="button" class="btn btn-danger" id="open-annexure-modal-btn">Generate Annexure</button>
            </div>
        </form>
    </div>

    <div id="add-buyer-modal" class="modal" style="display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6);">
        <div class="modal-content">
            <span class="close-btn" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
            <h2>Add New Buyer</h2>
            <form id="new-buyer-form">
                <div class="mb-3">
                    <label for="new-buyer-name" class="form-label">Buyer Name:</label>
                    <input type="text" id="new-buyer-name" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="new-buyer-address" class="form-label">Buyer Address:</label>
                    <textarea id="new-buyer-address" rows="4" class="form-control" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="new-buyer-terms" class="form-label">Terms of Shipment:</label>
                    <input type="text" id="new-buyer-terms" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="new-buyer-port" class="form-label">Port of Discharge:</label>
                    <input type="text" id="new-buyer-port" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Save Buyer</button>
            </form>
        </div>
    </div>
    
    <div id="annexure-modal" style="display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.4);">
        <div class="modal-content">
            <span id="close-annexure-modal" style="color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer;">&times;</span>
            <h2>Enter Annexure Details</h2>
            
            <div class="card my-3">
                <div class="card-body bg-light">
                    <div class="row">
                        <div class="col-md-4 mb-2"><label class="form-label">Commissionerate:</label><input type="text" id="annexure-commissionerate" value="Rajkot Commissionerate" class="form-control form-control-sm"></div>
                        <div class="col-md-4 mb-2"><label class="form-label">Division:</label><input type="text" id="annexure-division" value="Division II" class="form-control form-control-sm"></div>
                        <div class="col-md-4 mb-2"><label class="form-label">Range:</label><input type="text" id="annexure-range" value="Range V" class="form-control form-control-sm"></div>
                        <div class="col-md-6 mb-2"><label class="form-label">Permission No.:</label><input type="text" id="annexure-permission-no" class="form-control form-control-sm"></div>
                        <div class="col-md-6 mb-2"><label class="form-label">Bond No.:</label><input type="text" id="annexure-bond-no" class="form-control form-control-sm"></div>
                    </div>
                </div>
            </div>

            <h5>Container Details</h5>
            <p class="text-muted small">Please fill in details for each container below. Factory Name, Qty, Nett, and Gross will be pre-filled from the invoice but can be adjusted.</p>
            <div class="table-responsive">
                <table id="annexure-items-table" class="table table-bordered">
                    <thead>
                        <tr class="table-warning">
                            <th>Sr.No</th>
                            <th>Container No.</th>
                            <th>Size</th>
                            <th>Line Seal No.</th>
                            <th>E Seal No.</th>
                            <th>Factory Name</th>
                            <th>Qty (PCS)</th>
                            <th>Weight Nett (KGS)</th>
                            <th>Weight Gross (KGS)</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="annexure-items-body"></tbody>
                </table>
            </div>
            <button type="button" id="add-annexure-row-btn" class="btn btn-secondary mt-3">+ Add Container</button>
            <hr>
            <button type="button" id="generate-print-annexure-btn" class="btn btn-success">Generate & Print Annexure</button>
        </div>
    </div>
    
    <template id="annexure-html-template">
        <div class="print-template" style="font-size: 10pt; border: 1px solid #000; padding: 15px; font-family: 'Times New Roman', Times, serif;">
            <h3 style="text-align: center; margin: 0; font-weight: bold; text-decoration: underline;">Annexure</h3>
            <h4 style="text-align: center; margin: 5px 0;">Office Of The Supritendent Of Central GST</h4>
            <h4 style="text-align: center; margin: 5px 0;">{{division}} {{commissionerate}}</h4>
            <h4 style="text-align: center; margin: 5px 0 15px 0;">Examination Report For Factory Sealed Packages / Containers</h4>
            <table style="width: 100%; border-collapse: collapse; border: none; font-size: 11pt;">
                 <tbody>
                    <tr><td style="border: none; width: 35%;">1. Name Of Exporter</td><td style="border: none; font-weight: bold;">: {{exporter_name}}</td></tr>
                    <tr><td style="border: none;">2. (a) I.E.C. Code No.</td><td style="border: none; font-weight: bold;">: {{iec_no}}</td></tr>
                    <tr><td style="border: none;">&nbsp;&nbsp;&nbsp;&nbsp;(b) Branch Code No.</td><td style="border: none; font-weight: bold;">: N/A</td></tr>
                    <tr><td style="border: none;">&nbsp;&nbsp;&nbsp;&nbsp;(c) Bin No.</td><td style="border: none; font-weight: bold;">: --</td></tr>
                    <tr style="vertical-align: top;"><td style="border: none; padding-top: 4px;">3. Name Of The Manufacturer</td><td style="border: none; padding-top: 4px; font-weight: bold;">: {{manufacturer_name}}</td></tr>
                    <tr style="vertical-align: top;"><td style="border: none; padding-top: 4px;">&nbsp;&nbsp;&nbsp;&nbsp;Factory Address</td><td style="border: none; padding-top: 4px; font-weight: bold;">: {{manufacturer_address}}</td></tr>
                    <tr><td style="border: none;">&nbsp;&nbsp;&nbsp;&nbsp;GST No</td><td style="border: none; font-weight: bold;">: {{manufacturer_gst}}</td></tr>
                    <tr><td style="border: none; padding: 4px 0;" colspan="2"></td></tr>
                    <tr><td style="border: none;">5. Date Of Examination</td><td style="border: none; font-weight: bold;">: {{date}}</td></tr>
                    <tr><td style="border: none;">6. Name And Designation Of The Officer</td><td style="border: none; font-weight: bold;">: As Below</td></tr>
                    <tr><td style="border: none;">7. Name Of Superintendent</td><td style="border: none; font-weight: bold;">: As Below</td></tr>
                    <tr style="vertical-align: top;"><td style="border: none; padding-top: 4px;">8. Particulars Of Invoice</td><td style="border: none; padding-top: 4px; font-weight: bold;">: Inv No. {{invoice_no}}&nbsp;&nbsp;&nbsp;&nbsp;Date: {{date}}</td></tr>
                    <tr><td style="border: none;">&nbsp;&nbsp;&nbsp;&nbsp;Total Nos Of Packages & KGS</td><td style="border: none; font-weight: bold;">: {{total_items}}</td></tr>
                    <tr><td style="border: none;">9. Name Of The Consignee & Address</td><td style="border: none; font-weight: bold;">: To The Order</td></tr>
                </tbody>
            </table>

            <p style="margin-top: 20px;">(B) For Containerized Cargo:</p>
           <table style="width: 100%; border-collapse: collapse; text-align: center;" border="1">
                <thead>
                    <tr>
                        <th rowspan="2">Sr.No</th>
                        <th rowspan="2">Container No.</th>
                        <th rowspan="2">Size</th>
                        <th rowspan="2">Line Seal No.</th>
                        <th rowspan="2">E Seal No.</th>
                        <th colspan="2">Factory</th>
                        <th colspan="2">Weight</th>
                    </tr>
                    <tr>
                        <th>Name</th>
                        <th>Boxes</th>
                        <th>Nett</th>
                        <th>Gross</th>
                    </tr>
                </thead>
                <tbody></tbody>
                <tfoot style="border-top: 2px solid black;">
                    </tfoot>
            </table>
         
                   <table style="width: 100%; border-collapse: collapse; text-align: center;" border="1">
                       <tr>
             <td colspan="4" style="padding: 5px; text-align: left;">
                            Permission No. <br>
                            <strong style="font-size: 12pt;">{{permission_no}}</strong>
                        </td>
                        <td colspan="3" style="padding: 5px; text-align: left;">
                            Bond No <br>
                            <strong style="font-size: 12pt;">{{bond_no}}</strong>
                        </td>
</tr>
</table>
            <div style="margin-top: 20px; font-size: 9pt;">
                <p style="margin: 4px 0;">12. (a) Certified that the description and value of the goods covered by this invoice have been checked by me and that, goods have been packed and sealed with one time seal no under my supervision with name designation & rubber stamp.</p>
                <p style="margin: 4px 0;">(b) We Have Followed The Procedure Laid Down V/30-30/MP/2007 Dated : 25.10.2009 As Amended Against.</p>
            </div>
            
            <table style="width: 100%; margin-top: 50px; border: none;">
                 <tr style="vertical-align: top;">
                    <td style="border: none; width: 50%;">
                        <p style="margin:0;">Place: Gandhidham</p>
                        <p style="margin:0;">Date: {{date}}</p>
                    </td>
                    <td style="border: none; text-align: center;">
                        <p style="margin-top: 30px;">_________________________________</p>
                        <p style="margin:0;">Signature</p>
                        <p style="margin:0;">(Name of Inspector of Central Excise)</p>
                        <p style="margin:0;">With Name and Rubber Stamp</p>
                    </td>
                </tr>
            </table>
        </div>
    </template>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-init.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script src="script.js"></script>
    <script src="packing-list.js"></script>
    <script src="annexure-generator.js"></script>

</body>

</html>
